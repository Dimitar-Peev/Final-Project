<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

    <head th:replace="~{fragments/commons :: head('Edit Event')}"></head>

    <body>

        <div th:replace="~{fragments/commons :: header}"></div>

        <section class="page-header edit-event-header">
            <div class="container">
                <h1>Edit Event</h1>
                <p>Update your event details</p>
            </div>
        </section>

        <section class="event-edit-section" sec:authorize="hasAnyRole('EVENT_ORGANIZER','ADMIN')">
            <div class="container form-container">
                <form th:action="@{/events/{id}(id=${eventEditRequest.id})}"  th:object="${eventEditRequest}" th:method="put" class="event-form">

                    <div th:if="${errorMessage}" class="alert danger">
                        <p th:text="${errorMessage}"></p>
                    </div>

                    <div class="form-group">
                        <label for="title">Event Title</label>
                        <input type="text" id="title" name="title" th:field="*{title}">
                        <span th:if="${#fields.hasErrors('title')}" th:errors="*{title}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" th:field="*{description}" rows="4" ></textarea>
                        <span th:if="${#fields.hasErrors('description')}" th:errors="*{description}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="category">Category</label>
                        <select id="category" th:field="*{categoryId}" >
                            <option value="">-- Select Category --</option>
                            <option th:each="category : ${categories}"
                                    th:value="${category.id}"
                                    th:text="${category.name}">
                            </option>
                        </select>
                        <span th:if="${#fields.hasErrors('categoryId')}" th:errors="*{categoryId}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="venue">Venue</label>
                        <select id="venue" th:field="*{venueId}" >
                            <option value="">-- Select Venue --</option>
                            <option th:each="venue : ${venues}"
                                    th:value="${venue.id}"
                                    th:text="${venue.name + ' (' + venue.city + ')'}">
                            </option>
                        </select>
                        <span th:if="${#fields.hasErrors('venueId')}" th:errors="*{venueId}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="startDate">Start Date & Time</label>
                        <input type="datetime-local" id="startDate" th:field="*{startDate}">
                        <span th:if="${#fields.hasErrors('startDate')}" th:errors="*{startDate}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="endDate">End Date & Time</label>
                        <input type="datetime-local" id="endDate" th:field="*{endDate}">
                        <span th:if="${#fields.hasErrors('endDate')}" th:errors="*{endDate}" class="error-message"></span>
                        <span th:if="${#fields.hasErrors('endDateAfterStartDate')}" th:errors="*{endDateAfterStartDate}"
                              class="error-message" style="font-size: 15px">Error message</span>
                    </div>

                    <div class="form-group">
                        <label for="capacity">Max Capacity</label>
                        <input type="number" id="capacity" th:field="*{maxCapacity}" >
                        <span th:if="${#fields.hasErrors('maxCapacity')}" th:errors="*{maxCapacity}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label for="ticketPrice">Ticket Price</label>
                        <input type="number" id="ticketPrice" th:field="*{ticketPrice}" step="0.01">
                        <span th:if="${#fields.hasErrors('ticketPrice')}" th:errors="*{ticketPrice}" class="error-message"></span>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Update Event</button>
                        <a th:href="@{/events/my}" class="btn btn-primary">Cancel</a>
                    </div>
                </form>
            </div>
        </section>

        <footer th:replace="~{fragments/commons :: footer}"></footer>

    </body>
</html>